owid <- read_csv("owid-co2-data.csv")
library(tidyverse)
owid <- read_csv("owid-co2-data.csv")
View(owid)
owid %>%
rename(co2_miot = co2) %>%  #make clear that total co2 emissions are measured in million tonnes
rename(consumption_co2_miot = consumption_co2) #same for consumption-based emissions
owids <- owid %>%
group_by(country) %>%
mutate(cumulatives_co2 = sum(cumulative_co2))
owids %>%
head()
<<<<<<< Updated upstream
library(tidyverse)
library(plotly)
owid <- read_csv("owid-co2-data.csv")
owid %>%
rename(co2_miot = co2) %>%  #make clear that total co2 emissions are measured in million tonnes
rename(consumption_co2_miot = consumption_co2) #same for consumption-based emissions
owids <- owid %>%
group_by(country) %>%
mutate(cumulatives_co2 = sum(cumulative_co2))
owids %>%
head()
owids %>% colnames()
owid %>%
mutate(cucumulative_co2 = summarise(cumulative_co2)) %>%
ggplot(aes(x = cumulative_co2, y = consumption_co2)) +
geom_point()
owids %>%
filter(year == 2020) %>%
ggplot(aes(x = cumulative_co2, y = consumption_co2)) +
geom_point()
owids <- owid %>%
group_by(country) %>%
mutate(cumulatives_co2 = sum(cumulative_co2)) %>%
drop_na()
View(owids)
owids %>%
filter(year == 2020) %>%
ggplot(aes(x = cumulative_co2, y = consumption_co2)) +
geom_point()
is.numeric(owids$consumption_co2)
owids %>%
filter(year == 2020) %>%
ggplot(aes(x = cumulative_co2, y = consumption_co2)) +
geom_point(size = population)
owids %>%
filter(year == 2020) %>%
ggplot(aes(x = cumulative_co2, y = consumption_co2, size = population)) +
geom_point()
View(owids)
owid %>%
drop_na() %>%
filter(year == 2020) %>%
ggplot(aes(x = cumulative_co2, y = consumption_co2, size = population)) +
geom_point()
library(ggplot2)
owid %>%
drop_na() %>%
filter(year == 2019) %>%
=======
install.packages('ggplotly')
install.packages('plotly')
install.packages('plotly')
owid %>%
ggplot(aes(x = cumulative_co2, y = consumption_co2, size = population)) +
geom_point()
owid %>%
drop_na() %>%
ggplot(aes(x = cumulative_co2, y = consumption_co2, size = population)) +
geom_point()
owid %>%
drop_na() %>%
filter(year = 1990) %>%
>>>>>>> Stashed changes
ggplot(aes(x = cumulative_co2, y = consumption_co2, size = population)) +
geom_point()
owid %>%
drop_na() %>%
<<<<<<< Updated upstream
filter(year == 2020) %>%
=======
>>>>>>> Stashed changes
ggplot(aes(x = cumulative_co2, y = consumption_co2, size = population)) +
geom_point()
owid %>%
drop_na() %>%
<<<<<<< Updated upstream
filter(year == 2020) %>%
=======
>>>>>>> Stashed changes
ggplot(aes(x = co2, y = consumption_co2, size = population)) +
geom_point()
owid %>%
drop_na() %>%
<<<<<<< Updated upstream
#  filter(year == 2020) %>%
ggplot(aes(x = co2, y = consumption_co2, size = population)) +
geom_point()
owids %>%
drop_na() %>%
#  filter(year == 2020) %>%
ggplot(aes(x = co2, y = consumption_co2, size = population)) +
geom_point()
owid %>%
drop_na() %>%
#  filter(year == 2020) %>%
ggplot(aes(x = co2, y = consumption_co2, size = population)) +
geom_point()
owid %>%
drop_na() %>%
#  filter(year == 2020) %>%
ggplot(aes(x = co2, y = consumption_co2, size = population, colour = country)) +
geom_point()
owid %>%
drop_na() %>%
filter(year == 2018) %>%
ggplot(aes(x = co2, y = consumption_co2, size = population, colour = country)) +
geom_point()
owid %>%
drop_na() %>%
filter(year == 2018) %>%
mutate(pop = population/1000000, 2) %>%
ggplot(aes(x = co2, y = consumption_co2, size = population, colour = country)) +
geom_point()
install.packages("shiny")
library(shiny)
runExample("01_hello")
plot <- owid %>%
drop_na() %>%
filter(year == 2018) %>%
mutate(pop = population/1000000, 2) %>%
ggplot(aes(x = co2, y = consumption_co2, size = population, colour = country)) +
geom_point()
ui <- fluidPage(
titlePanel("Production based vs. Consumption based CO2 Emissions"),
sidebarLayout(
sidebarPanel(
sliderInput(inputId = year,
label = "Year",
min = 1990,
max = 2018,
value = 2018)
),
mainPanel(
plotOutput(outputId = "plot")
)
)
)
ui <- fluidPage(
titlePanel("Production based vs. Consumption based CO2 Emissions"),
sidebarLayout(
sidebarPanel(
sliderInput(inputId = owid$year,
label = "Year",
min = 1990,
max = 2018,
value = 2018)
),
mainPanel(
plotOutput(outputId = "plot")
)
)
)
server <- function(input, output) {
output$plot <- renderPlot({
data <- switch(input$var,
"Consumption-based" = owid$consumption_co2,
"Production-based" = owid$co2,
"Population" = pop)
})
}
# Create Shiny app ----
shinyApp(ui = ui, server = server)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(plotly)
library(countrycode)
setwd("C:/Users/Anna/Desktop/Hertie/second_year/GHG-project")
#setwd("C:/Users/Anna/Desktop/Hertie/second_year/GHG-project")
owid <- read_csv("owid-co2-data.csv")
owid<-owid%>%mutate(gdp_per_capita=gdp/population)
figure_1 <- owid %>% filter(!is.na(consumption_co2))%>% filter(country %in% c("World", "Africa", "North America", "Europe (excl. EU-28)", "South America", "Asia", "Australia", "Asia (excl. China & India)", "European Union (28)", "North America (excl. USA)", "Oceania"))%>%
filter(year==2019) %>%
arrange(desc(consumption_co2)) %>%
ggplot(.,aes(x=consumption_co2,y=reorder(country,consumption_co2))) +
geom_col(color="#636363",fill="#BD1550") +
scale_fill_brewer(palette="Set2") +
theme_bw() +
theme(axis.title.y = element_blank()) +
xlab("") +
ggtitle("Consumption of CO2 per region in 2019")+guides(fill=guide_legend(title=" "))
#ggsave("Rule 4.png", final_grid, width = 10, height = 8)
figure_1 <- owid %>% filter(!is.na(consumption_co2))%>% filter(country %in% c("World", "Africa", "North America", "Europe (excl. EU-28)", "South America", "Asia", "Australia", "Asia (excl. China & India)", "European Union (28)", "North America (excl. USA)", "Oceania"))%>%
filter(year==2019) %>%
arrange(desc(consumption_co2)) %>%
ggplot(.,aes(x=consumption_co2,y=reorder(country,consumption_co2))) +
geom_col(color="#636363",fill="#BD1550") +
scale_fill_brewer(palette="Set2") +
theme_bw() +
theme(axis.title.y = element_blank()) +
xlab("") +
ggtitle("Consumption of CO2 per region in 2019")+guides(fill=guide_legend(title=" "))
ggsave("Fig. 1 Cosumption by Region 2019", figure_1, width = 10, height = 8)
?plot_dev
?plot_dev()
ggsave("Fig. 1 Cosumption by Region 2019", plot = figure_1, width = 10, height = 8)
ggsave("Fig. 1 Cosumption by Region 2019", plot = figure_1, device = "png", width = 10, height = 8)
figure_2 <- owid %>% filter(!is.na(cumulative_co2))%>% filter(country %in% c("World", "Africa", "North America", "Europe (excl. EU-28)", "South America", "Asia", "Australia", "Asia (excl. China & India)", "European Union (28)", "North America (excl. USA)", "Oceania"))%>%
filter(year==2019) %>%
arrange(desc(cumulative_co2)) %>%
ggplot(.,aes(x=cumulative_co2,y=reorder(country,cumulative_co2))) +
geom_col(color="#636363",fill="#490A3D") +
theme_bw() +
theme(axis.title.y = element_blank()) +
xlab("") +
ggtitle("Production of CO2 per region in 2019")+guides(fill=guide_legend(title=" "))
ggsave("Fig. 2 Production by Region 2019", plot = figure_2, device = "png", width = 10, height = 8)
figure_1 <- owid %>% filter(!is.na(consumption_co2))%>% filter(country %in% c("World", "Africa", "North America", "Europe (excl. EU-28)", "South America", "Asia", "Australia", "Asia (excl. China & India)", "European Union (28)", "North America (excl. USA)", "Oceania"))%>%
filter(year==2019) %>%
arrange(desc(consumption_co2)) %>%
ggplot(.,aes(x=consumption_co2,y=reorder(country,consumption_co2))) +
geom_col(color="#636363",fill="#BD1550") +
scale_fill_brewer(palette="Set2") +
theme_bw() +
theme(axis.title.y = element_blank()) +
xlab("") +
ggtitle("Consumption of CO2 per region in 2019")+guides(fill=guide_legend(title=" "))
ggsave("Fig. 1 Consumption by Region 2019", plot = figure_1, device = "png", width = 10, height = 8)
ggsave("Fig. 3 share of consumption by region s1990", plot = figure_1, device = "png", width = 10, height = 8)
ggsave("Fig. 3 share of consumption by region s1990", plot = figure_3, device = "png", width = 10, height = 8)
figure_3 <- owid %>%
filter(country %in% c( "Africa", "North America", "Europe", "South America", "Asia", "Australia", "Asia (excl. China & India)", "North America (excl. USA)", "Oceania")) %>%
ggplot(.,aes(x=year,y=consumption_co2,fill=country)) +
geom_area(color="#636363", position="fill") +
theme_bw() +
scale_fill_brewer(palette="RdPu") +
ylab("") +
theme(axis.title.x=element_blank()) +
ggtitle(paste0("Share of CO2 consumption across regions since 1990"))+guides(fill=guide_legend(title=" "))
ggsave("Fig. 3 share of consumption by region s1990", plot = figure_3, device = "png", width = 10, height = 8)
figure_4 <- owid %>% filter(year>1990) %>%
filter(country %in% c("Africa", "North America", "Europe", "South America", "Asia", "Australia", "Asia (excl. China & India)", "North America (excl. USA)", "Oceania")) %>%
ggplot(.,aes(x=year,y=cumulative_co2,fill=country)) +
geom_area(color="#636363", position="fill") +
theme_bw() +
scale_fill_brewer(palette="BuPu") +
ylab("") +
theme(axis.title.x=element_blank()) +
ggtitle(paste0("Share of CO2 production across regions since 1990"))+guides(fill=guide_legend(title=" "))
ggsave("Fig. 4 share of production by region s1990", plot = figure_4, device = "png", width = 10, height = 8)
figure_1
figure_2
figure_3
figure_4
figure_5 <- owid %>% filter(!is.na(consumption_co2))%>% filter(!country %in% c("World", "Africa", "North America", "Europe (excl. EU-28)", "South America", "Asia", "Australia", "Asia (excl. China & India)", "European Union (28)", "Europe","Europe (excl. EU-27)", "European Union (27)", "High-income countries", "Upper-middle-income countries", "Lower-middle-income countries", "North America (excl. USA)","Oceania" ))%>%
filter(year==2018) %>%
arrange(desc(consumption_co2)) %>%
head(10) %>%
ggplot(.,aes(x=consumption_co2,y=reorder(country,consumption_co2))) +
geom_col(color="#636363",fill="#BD1550") +
scale_fill_brewer(palette="Set2") +
theme_bw() +
theme(axis.title.y = element_blank()) +
xlab("") +
ggtitle("Consumption of CO2 per country in 2018")
ggsave("Fig. 5 consumption by country 2018", plot = figure_5, device = "png", width = 10, height = 8)
figure_6 <- owid %>% filter(!is.na(consumption_co2))%>% filter(!country %in% c("World", "Africa", "North America", "Europe (excl. EU-28)", "South America", "Asia", "Australia", "Asia (excl. China & India)", "European Union (28)", "Europe","Europe (excl. EU-27)", "European Union (27)", "High-income countries", "Upper-middle-income countries", "Lower-middle-income countries", "North America (excl. USA)",  "Oceania" ))%>%
filter(year==2018) %>%
arrange(desc(cumulative_co2)) %>%
head(10) %>%
ggplot(.,aes(x=cumulative_co2,y=reorder(country,cumulative_co2))) +
geom_col(color="#636363",fill="#490A3D") +
theme_bw() +
theme(axis.title.y = element_blank()) +
xlab("") +
ggtitle("Production of CO2 per country in 2018")
ggsave("Fig. 6 production by country 2018", plot = figure_6, device = "png", width = 10, height = 8)
figure_5
figure_6
figure_7 <- owid %>% filter(year>1990)%>%
filter(country %in% c( "High-income countries", "Upper-middle-income countries", "Lower-middle-income countries", "Low-income countries")) %>%
ggplot(.,aes(x=year,y=consumption_co2,fill=country)) +
geom_area(color="#636363", position="fill") +
theme_bw() +
scale_fill_brewer(palette="RdPu") +
ylab("") +
theme(axis.title.x=element_blank()) +
ggtitle(paste0("Share of consumption based CO2 emissions by income"))+guides(fill=guide_legend(title=" "))
ggsave("Fig. 7 consumption by income s1990", plot = figure_1, device = "png", width = 10, height = 8)
figure_8 <- owid %>% filter(year>1990) %>%
filter(country %in% c( "High-income countries", "Upper-middle-income countries", "Lower-middle-income countries", "Low-income countries")) %>%
ggplot(.,aes(x=year,y=cumulative_co2,fill=country)) +
geom_area(color="#636363", position="fill") +
theme_bw() +
scale_fill_brewer(palette="BuPu") +
ylab("") +
theme(axis.title.x=element_blank()) +
ggtitle(paste0("Share of CO2 production based CO2 emissions by income"))+guides(fill=guide_legend(title=" "))
ggsave("Fig. 8 production by income s1990", plot = figure_1, device = "png", width = 10, height = 8)
figure_7
figure_8
owid_bubbles <- owid %>%  filter(!is.na(country))%>% filter(!country %in% c("World", "Africa", "North America", "Europe (excl. EU-28)", "South America", "Asia","Asia (excl. China & India)", "European Union (28)", "Europe","Europe (excl. EU-27)", "European Union (27)", "High-income countries", "Upper-middle-income countries", "Lower-middle-income countries", "North America (excl. USA)", "Oceania", "International transport", "Kuwaiti Oil Fires"))%>%
mutate(continent = countrycode(iso_code, origin = "iso3c", destination = "continent"))
figure_9 <- owid_bubbles %>%filter(year==2018) %>%  filter(!is.na(gdp_per_capita)&!is.na(cumulative_co2)&!is.na(consumption_co2))%>%arrange(desc(gdp_per_capita)) %>%
head(20) %>% plot_ly( x = ~cumulative_co2, y = ~consumption_co2, type = 'scatter', mode = 'markers', size = ~gdp_per_capita, color = ~country, colors = 'Paired',
sizes = c(50, 1000))
figure_9 <- figure_9 %>%
layout(title = 'Consumption vs production based emissions (top 20 by GDP per capita)',
xaxis = list(title = 'Production of CO2 in million tonnes'),
yaxis = list(title = 'Consumption of CO2 in million tonnes'))
figure_9
figure_10 <- owid_bubbles %>%
filter(year==2018) %>%
filter(!is.na(gdp_per_capita)&!is.na(cumulative_co2)&!is.na(consumption_co2)) %>%
arrange(desc(gdp_per_capita)) %>%
top_n(-20) %>%
plot_ly( x = ~cumulative_co2, y = ~consumption_co2, type = 'scatter', mode = 'markers', size = ~gdp_per_capita, color = ~country, colors = 'Paired',
sizes = c(50, 1000))
figure_10 <- figure_10 %>%
layout(title = 'Consumption vs production based emissions (bottom 20 by GDP per capita)',
xaxis = list(title = 'Production of CO2 in million tonnes'), yaxis = list(title = 'Consumption of CO2 in million tonnes'))
figure_10
ggsave("Fig. 9 con vs prod top10gdp/c", plot = figure_1, device = "png", width = 10, height = 8)
ggsave("Fig. 9 con vs prod top10gdpc", plot = figure_1, device = "png", width = 10, height = 8)
ggsave("Fig. 9 con vs prod top10gdpc", plot = figure_9, device = "png", width = 10, height = 8)
orca(fugure_9, "con vs prod top10gdpc")
figure_9 <- owid_bubbles %>%filter(year==2018) %>%  filter(!is.na(gdp_per_capita)&!is.na(cumulative_co2)&!is.na(consumption_co2))%>%arrange(desc(gdp_per_capita)) %>%
head(20) %>% plot_ly( x = ~cumulative_co2, y = ~consumption_co2, type = 'scatter', mode = 'markers', size = ~gdp_per_capita, color = ~country, colors = 'Paired',
sizes = c(50, 1000))
figure_9 <- figure_9 %>%
layout(title = 'Consumption vs production based emissions (top 20 by GDP per capita)',
xaxis = list(title = 'Production of CO2 in million tonnes'),
yaxis = list(title = 'Consumption of CO2 in million tonnes'))
orca(fugure_9, "con vs prod top10gdpc.png")
orca(figure_9, "con vs prod top10gdpc.png")
orca(figure_9, "Fig. 9 con vs prod top10gdpc.png")
figure_10 <- owid_bubbles %>%
filter(year==2018) %>%
filter(!is.na(gdp_per_capita)&!is.na(cumulative_co2)&!is.na(consumption_co2)) %>%
arrange(desc(gdp_per_capita)) %>%
top_n(-20) %>%
plot_ly( x = ~cumulative_co2, y = ~consumption_co2, type = 'scatter', mode = 'markers', size = ~gdp_per_capita, color = ~country, colors = 'Paired',
sizes = c(50, 1000))
figure_10 <- figure_10 %>%
layout(title = 'Consumption vs production based emissions (bottom 20 by GDP per capita)',
xaxis = list(title = 'Production of CO2 in million tonnes'), yaxis = list(title = 'Consumption of CO2 in million tonnes'))
figure_10
install.packages("leaflet")
library(leaflet)
library(tidyverse)
library(plotly)
library(countrycode)
library(leaflet)
total <- owid %>%
filter(country=="World") %>%
filter(year==2018) %>%
select(consumption_co2)
with_share <- owid %>%
filter(year==2018) %>%
filter(!is.na(gdp_per_capita)) %>%
mutate(share=(consumption_co2/36646.14)*100)
top_share<-with_share%>%arrange(desc(gdp_per_capita))%>%slice(1:10)%>%select(country, share)
top_share %>%
arrange(desc(share))
total_production <- owid %>%
filter(country=="World") %>%
filter(year==2018) %>%
select(cumulative_co2)
with_share_production <- owid %>%
filter(year==2018) %>%
filter(!is.na(gdp_per_capita)) %>%
mutate(share=(cumulative_co2/1625014)*100)
top_share_production <- with_share_production %>%
arrange(desc(gdp_per_capita)) %>%
slice(1:10)%>%select(country, share)
top_share_production %>%
arrange(desc(share))
=======
ggplot(aes(x = co2, y = consumption_co2, size = population)) +
geom_point()+ theme_bw()
owid %>%
drop_na() %>%
ggplot(aes(x = co2, y = consumption_co2, size = population, fill = country)) +
geom_point()+ theme_bw()
owid %>%
drop_na() %>%
ggplot(aes(x = co2, y = consumption_co2, size = population)) +
geom_point(fill = country)+ theme_bw()
owid %>%
drop_na() %>%
ggplot(aes(x = co2, y = consumption_co2, size = population, fill = country)) +
geom_point()+ theme_bw()
owid %>%
drop_na() %>%
ggplot(aes(x = co2, y = consumption_co2, size = population, fill = country)) +
geom_point()
owid %>%
drop_na() %>%
ggplot(aes(x = co2, y = consumption_co2, size = population, colour = country)) +
geom_point()+ theme_bw()
owid %>%
drop_na() %>%
mutate(pop = round(population/1000000, 2))
owid %>%
drop_na() %>%
mutate(pop = round(population/1000000, 2)) %>% # round by million
ggplot(aes(x = co2, y = consumption_co2, size = pop, colour = country)) +
geom_point()+ theme_bw()
owid %>%
drop_na() %>%
filter(year == 1995) %>%
mutate(pop = round(population/1000000, 2)) %>% # round by million
ggplot(aes(x = co2, y = consumption_co2, size = pop, colour = country)) +
geom_point()+ theme_bw()
owid %>% names()
install.packages("shiny")
install.packages("shiny")
getwd()
install.packages("shiny")
>>>>>>> Stashed changes
